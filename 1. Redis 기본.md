# Redis 란?
- Redis는 Remote Dictionary Server의 약자로, 메모리 기반의 키-값 구조 데이터 관리 시스템이다.
- 데이터베이스의 일종으로, 빠른 읽기 및 쓰기 속도를 제공한다.

# 저장 방식
- 대부분의 데이터베이스가 디스크에 데이터를 저장하는 반면, Redis는 메인 메모리에 데이터를 저장한다.
- 그 결과, [디크스 I/O](https://hazel-developer.tistory.com/244)가 필요한 다른 형태의 데이터베이스보다 훨씬 빠른 속도를 제공한다.
- 이로인해 데이터의 영구성이 문제가 될수 있다.(해결방법 : 스냅샷, AOF(Append Only File))

# 특징과 장점
- __속도__: Redis는 메모리 기반의 데이터베이스로, 데이터를 디스크보다 빠른 메모리에 저장하고 접근할 수 있다. 이로인해 매우 빠른 읽기 민ㅊ 쓰기 속도를 제공한다.
- __데이터 타입 지원__: Redis는 단순한 키-값 저장소를 넘어 다양한 데이터 타입을 지원한다. 문자열, 리스트, 해시, 세트, 정렬된 세트 등 다양한 데이터 타입을 제공하며, 이를 통해 다양한 환경에서 유연하게 사용할 수 있다.
- __데이터 영속성 보장__: Redis는 RDB와 AOF 방식을 통해 메모리에 저장된 데이터의 영속성을 보장한다. 이를 통해 시스템 재시작이나 다운 등의 상황에서도 데이터를 안전하게 보호할 수 있다.
- __Pub/Sub 기능__: Redis는 매우 강력한 pub/sub 메시징 시스템을 제공한다. 이를 통해 채팅, 실시간 분석 등 다양한 어플리케이션에서 활용할 수 있다.
- __트랜잭션 지원__: Redis는 MULTI, EXEC, DISCARD, WATCH 등의 명령어를 통해 트랜잭션을 지원한다. 이러한 명령어들은 여러 개의 Redis 명령어가 원자적으로 실행되도록 보장한다.
- __LUA 스크립팅 지원__ : Redis는 내장 LUA 인터프리터를 제공하여 서버 측에서 LUA 스크립트 실행을 지원한다.
- __레플리케이션 지원__ : Redis는 마스터-슬레이브 구조의 레플리케이션을 지원한다. 이를 통해 데이터 복제 및 분산 처리가 가능하며, 고가용성과 부하 분산을 위해 활용할 수 있다.


### 💡 트랜젝션 이란?
- 테이터 베이스에서 여러개의 명렁을 하나의 단위로 묶는 방법을 말한다.
- 이렇게 묶인 명령어들은 모두 성공하거나, 모두 실패하거나, 둘중 하나의 결과를 가진다.
- 이를 <span style = "color:green">__"원자성"__</span> 이라고 부르며, 트랜잭션에서 가장 중요한 특징이다.
    #### 'MULTI', 'EXEC', 'DISCARD', 'WATCH' 등의 명령어를 제공하여 트랜잭션을 지원
    - MULTI : 트랜잭션을 시작하는 명령어. 이 명령어가 호출되면, 그 후에 실행되는 모든 명령어들은 큐에 저장된다.
    - EXEC : MULTI로 시작된 트랜잭션을 실행하는 명령어. 이 명령어가 호출되면, 큐에 저장된 모든 명령어들이 순차적으로 실행된다.
    - DISCARD : MULTI로 시작된 트랜잭션을 취소하는 명령어. 이 명령어가 호출되면, 큐에 저장된 모든 명령어들이 삭제된다.
    - WATCH : 주어진 키들에 대한 변경을 감시하는 명령어. 만약 WATCH로 감시하고 있는 키가 다른 클라이언트에 의해 변경되었다면, 트랜잭션은 실패하게 된다.

### 💡 레플리케이션 이란?
- 한 서버의 데이터를 다른 서버에 복사하는 기술을 말한다.
- 이는 데이터의 안정성을 높이고, 부하 분산을 통한 성능 향상을 도모하는데 사용된다.
- 데이터 안정성: 만약 마스터가 다운되더라도, 슬레이브에서 데이터를 복구할 수 있으므로 데이터 손실을 방지할 수 있다.
- 부하 분산: 슬레이브가 읽기 요청을 처리하므로, 마스터는 쓰기 요청에만 집중할 수 있다.

    #### 마스터 - 슬레이브 구조
  - 마스터(Master): 클라이언트로부터 데이터 변경 명령(삽입, 수정, 삭제 등)을 받아 처리합니다. 그리고 이 변경사항을 슬레이브에 전달하여 데이터를 동기화한다.
  - 슬레이브(Slave): 마스터로부터 데이터 변경사항을 받아 자신의 데이터를 업데이트합니다. 그리고 클라이언트의 읽기 요청을 처리하여 부하를 분산시킨다.

# Redis 주요 사용 사례
1. __캐싱__ : Redis는 빠른 읽기 및 쓰기 속도를 자랑하는 메모리 기반의 데이터베이스로, 웹 애플리케이션의 캐시로 자주 사용됩니다. 데이터베이스로부터 데이터를 가져오는 것보다 Redis에서 데이터를 직접 가져오는 것이 훨씬 빠르기 때문에, 애플리케이션의 응답 시간을 줄여준다.
2. __세션 스토어__ : Redis는 키-값 저장소의 특성을 활용하여 세션 정보를 저장하는데 사용될 수 있습니다. 사용자 프로필, 세션 상태, 사용자별 개인화 정보 등을 신속하게 저장하고 검색할 수 있다.
3. __메시지 큐__ : Redis의 Pub/Sub 기능을 활용하면, 메시지 큐 혹은 작업 큐로 사용할 수 있습니다. 이는 비동기 작업 관리나, 여러 서비스 간의 데이터 전송 등에 활용 된다.
4. __실시간 분석__ : Redis는 매우 빠른 읽기 및 쓰기 속도 때문에 실시간 분석에도 유용합니다. 예를 들어 로그 또는 클릭 스트림 분석 같은 곳에서 활용된다.
5. __리더보드 및 카운팅__ : 정렬된 세트(sorted set) 데이터 타입을 이용하면, 게임에서의 리더보드 구현이나 실시간 카운팅 등의 작업을 쉽게 처리할 수 있다.

# Redis 영속성(Persistence)
- Redis는 메모리기반의 데이터베이스 이지만, 영속성을 보장하기 위해 두가지 방식을 제공한다.
- 최근의 Redis 버전에서는 RDB와 AOF를 동시에 사용하는 것을 권장하고있다.
- __RDB(Redis DataBase)__
  - RDB는 특정 시점의 데이터 스냅샷을 디스크에 저장하는 방식
  - 사용자가 설정한 시간간격(예: 5분마다 혹은 10분마다) 혹은 특정 조건(예: n개 이상의 변경이 발생하면)에 따라 자동으로 스냅샷을 생성하며, 이를 디스크에 저장한다.
  - 이 방식은 Redis가 죽었을 때 데이터 복구를 위한 빠른 방법을 제공하지만, 마지막 스냅샷 이후의 데이터는 복구할 수 없다는 단점이 있다.
- __AOF(Append Only File)__
  - 모든 변경사항(write operation)을 로그로 기록하여 디스크에 저장하는 방식
  - 모든 변경사항을 순차적으로 저장하므로, 장애 발생 시에도 데이터를 거의 완벽하게 복구할 수 있다.
  - 그러나 로그 파일의 크기가 커질 수 있고, 동일한 데이터에 대한 여러 번의 변경을 모두 기록한다는 점에서 공간 효율성이 떨어질 수 있다.
  - 하지만 Redis는 이러한 문제를 해결하기 위해 주기적인 로그 축소(rewrite) 작업을 지원한다.

# 캐싱(Caching) 방식[Cache-Aside]
### 읽기 작업
1. 애플리케이션이 특정 데이터를 요청하면, Redis에서 먼저 해당 데이터를 찾는다.
2. 만약 Redis가 해당 데이터를 가지고 있다면(캐시히트), 바로 그 값을 반환
3. 만약 Redis가 해당 데이터를 가지고 있지 않다면(캐시 미스), 원래의 데이터베이스에서 해당 데이터를 가져온 후 가져온 데이터를 Redis에 저장하여, 다음 번 같은 요청이 왔을 때 빠르게 응답할 수 있도록한다.

### 쓰기 작업
1. 클라이언트가 데이터를 변경하거나 삭제할 때 먼저 데이터 스토어에 대한 작업을 수행한다.
2. 같은 키의 캐시된 값을 무효화(예:삭제)한다.
3. 후속 읽기 작업은 캐시 미스를 일으키고, 최신 데이터를 데이터 스토어에서 가져온다.

### 장점
- 항상 최신의 데이터를 제공 : 쓰기 작업 시에 캐시 값을 무효화하기 때문에 캐시된 값이 항상 최신의 값임을 보장할 수 있다.
- 캐시 메모리의 효율적인 사용 : 이 패턴은 오직 요청된 데이터만 캐싱하므로, 사용하지 않는 데이터로 인한 캐시 메모리의 낭비를 피할 수 있다.

### 주의사항
- 캐시와 데이터 스토어 간의 일관성 유지 : 클라이언트는 쓰기 작업 시에 항상 캐시를 무효화 해야한다.
- 레이턴시 문제 : 캐시 미스가 발생하면, 클라이언트는 데이터 스토어로 부터 데이터를 가져와야 하므로 이 과정에서 추가적인 레이턴시가 발생할 수 있다.

⭐ Redis는 'key expiration' 기능을 제공하여, 일정 시간 동안 사용되지 않은 캐시 항목을 자동으로 삭제하므로 메모리 공간을 효율적으로 관리할 수 있다.
